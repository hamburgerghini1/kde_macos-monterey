(()=>{"use strict";var e,n={170:function(e,n,s){var t=this&&this.__awaiter||function(e,n,s,t){return new(s||(s=Promise))((function(i,o){function a(e){try{d(t.next(e))}catch(e){o(e)}}function r(e){try{d(t.throw(e))}catch(e){o(e)}}function d(e){var n;e.done?i(e.value):(n=e.value,n instanceof s?n:new s((function(e){e(n)}))).then(a,r)}d((t=t.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const i=s(542),o=s(147),a=s(683),r=s(657),d=s(887),l=s(465),c=s(707),u=new o.default;class m{constructor(e){this.messageListener=e}sendMessage(e,n,s){this.messageListener?this.messageListener(n,null,s):chrome.tabs?chrome.tabs.sendMessage(e,n,s):chrome.runtime.sendMessage({message:"tabs",data:n},s)}query(e,n){this.messageListener||!chrome.tabs?n([{url:document.URL,id:-1}]):chrome.tabs.query(e,n)}}let p=window===window.top;window.addEventListener("message",(e=>t(void 0,void 0,void 0,(function*(){if(e.source===window.parent)return e.origin.endsWith(".youtube.com")?p=!0:void 0})))),function(e){t(this,void 0,void 0,(function*(){const e=new m(undefined);(0,c.localizeHtmlPage)();let n=!1,s=[],o=null;const g={};["sponsorblockPopup","sponsorStart","whitelistChannel","unwhitelistChannel","whitelistToggle","whitelistForceCheck","disableSkipping","enableSkipping","toggleSwitch","showNoticeAgain","optionsButton","helpButton","submitTimes","sponsorTimesContributionsContainer","sponsorTimesContributionsDisplay","sponsorTimesViewsContainer","sponsorTimesViewsDisplay","sponsorTimesViewsDisplayEndWord","sponsorTimesOthersTimeSavedDisplay","sponsorTimesOthersTimeSavedEndWord","sponsorTimesSkipsDoneContainer","sponsorTimesSkipsDoneDisplay","sponsorTimesSkipsDoneEndWord","sponsorTimeSavedDisplay","sponsorTimeSavedEndWord","setUsernameContainer","setUsernameButton","setUsernameStatus","setUsernameStatus","setUsername","usernameInput","usernameValue","submitUsername","sbPopupIconCopyUserID","submissionHint","mainControls","loadingIndicator","videoFound","sponsorMessageTimes","refreshSegmentsButton","whitelistButton","sbDonate","sponsorTimesDonateContainer","sbConsiderDonateLink","sbCloseDonate","sbBetaServerWarning","sbCloseButton"].forEach((e=>g[e]=document.getElementById(e))),e.query({active:!0,currentWindow:!0},(a=>function(a,r){e.sendMessage(a[0].id,{message:"getVideoID"},(function(r){void 0!==r&&r.videoID?(o=r.videoID,n=r.creatingSegment,function(n,a){var r;t(this,void 0,void 0,(function*(){o?(yield u.wait((()=>null!==i.default.config),5e3,10),s=null!==(r=i.default.config.unsubmittedSegments[o])&&void 0!==r?r:[],T(),e.sendMessage(n[0].id,{message:"isInfoFound",updating:false},y)):b()}))}(a)):void 0===r&&chrome.runtime.lastError&&b()}))}(a))),yield u.wait((()=>null!==i.default.config&&p),5e3,5),document.querySelector("body").style.removeProperty("visibility"),g.sbCloseButton.addEventListener("click",(()=>{S({message:"closePopup"})})),window!==window.top&&g.sbCloseButton.classList.remove("hidden"),(0,r.showDonationLink)()||(g.sbDonate.style.display="none"),g.sbDonate.addEventListener("click",(()=>i.default.config.donateClicked=i.default.config.donateClicked+1)),i.default.config.testingServer&&(g.sbBetaServerWarning.classList.remove("hidden"),g.sbBetaServerWarning.addEventListener("click",(function(){C("advanced")}))),g.sponsorStart.addEventListener("click",(function(){e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{from:"popup",message:"sponsorStart"},(e=>t(this,void 0,void 0,(function*(){v(e);const n=e=>{const n=i.default.configSyncListeners.indexOf(e);-1!==n&&i.default.configSyncListeners.splice(n,1)},s=()=>{v(e),n(s)};i.default.configSyncListeners.push(s),setTimeout((()=>n(s)),200)}))))}))})),g.whitelistToggle.addEventListener("change",(function(){this.checked?e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"getChannelID"},(function(n){if(!n.channelID)return void alert(chrome.i18n.getMessage("channelDataNotFound")+" https://github.com/ajayyy/SponsorBlock/issues/753");let s=i.default.config.whitelistedChannels;null==s&&(s=[]),s.push(n.channelID),g.whitelistChannel.style.display="none",g.unwhitelistChannel.style.display="unset",document.querySelectorAll(".SBWhitelistIcon")[0].classList.add("rotated"),i.default.config.forceChannelCheck||g.whitelistForceCheck.classList.remove("hidden"),i.default.config.whitelistedChannels=s,e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"whitelistChange",value:!0})}))}))})):e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"getChannelID"},(function(n){let s=i.default.config.whitelistedChannels;null==s&&(s=[]);const t=s.indexOf(n.channelID);s.splice(t,1),g.whitelistChannel.style.display="unset",g.unwhitelistChannel.style.display="none",document.querySelectorAll(".SBWhitelistIcon")[0].classList.remove("rotated"),g.whitelistForceCheck.classList.add("hidden"),i.default.config.whitelistedChannels=s,e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"whitelistChange",value:!1})}))}))}))})),g.whitelistForceCheck.addEventListener("click",(()=>{C("behavior")})),g.toggleSwitch.addEventListener("change",(function(){!function(e){i.default.config.disableSkipping=e;let n=g.disableSkipping,s=g.enableSkipping;e||(n=g.enableSkipping,s=g.disableSkipping),s.style.display="unset",n.style.display="none"}(!this.checked)})),g.submitTimes.addEventListener("click",(function(){s.length>0&&e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"submitTimes"})}))})),g.showNoticeAgain.addEventListener("click",(function(){i.default.config.dontShowNotice=!1,g.showNoticeAgain.style.display="none"})),g.setUsernameButton.addEventListener("click",w),g.usernameValue.addEventListener("click",w),g.submitUsername.addEventListener("click",(function(){g.setUsernameStatus.style.display="unset",g.setUsernameStatus.innerText=chrome.i18n.getMessage("Loading"),u.sendRequestToServer("POST","/api/setUsername?userID="+i.default.config.userID+"&username="+g.usernameInput.value,(function(e){200==e.status?(g.submitUsername.style.display="none",g.usernameInput.style.display="none",g.setUsernameContainer.style.removeProperty("display"),g.setUsername.classList.remove("SBExpanded"),g.usernameValue.innerText=g.usernameInput.value,g.setUsernameStatus.style.display="none",g.sponsorTimesContributionsContainer.classList.remove("hidden")):g.setUsernameStatus.innerText=l.GenericUtils.getErrorMessage(e.status,e.responseText)})),g.setUsernameContainer.style.display="none",g.setUsername.style.display="unset"})),g.optionsButton.addEventListener("click",(function(){chrome.runtime.sendMessage({message:"openConfig"})})),g.helpButton.addEventListener("click",(function(){chrome.runtime.sendMessage({message:"openHelp"})})),g.refreshSegmentsButton.addEventListener("click",(function(){const n=d.AnimationUtils.applyLoadingAnimation(g.refreshSegmentsButton,.3);e.query({active:!0,currentWindow:!0},(s=>{e.sendMessage(s[0].id,{message:"refreshSegments"},(e=>{y(e),n()}))}))})),g.sbPopupIconCopyUserID.addEventListener("click",(()=>t(this,void 0,void 0,(function*(){return D(yield u.getHash(i.default.config.userID))}))));const h=i.default.config.disableSkipping;null!=h&&h&&(g.disableSkipping.style.display="none",g.enableSkipping.style.display="unset",g.toggleSwitch.checked=!1);const f=i.default.config.dontShowNotice;function y(n){chrome.runtime.lastError?b():(null!=n&&(g.mainControls.style.display="block",n.onMobileYouTube&&g.mainControls.classList.add("hidden"),g.whitelistButton.classList.remove("hidden"),g.loadingIndicator.style.display="none",n.found?(g.videoFound.innerHTML=chrome.i18n.getMessage("sponsorFound"),function(n){var s;if(null!=n.sponsorTimes){const t=n.sponsorTimes.sort(((e,n)=>e.segment[1]-n.segment[1])).sort(((e,n)=>e.segment[0]-n.segment[0])),o=document.getElementById("issueReporterTimeButtons");for(;o.firstChild;)o.removeChild(o.firstChild);const r=i.default.config.isVip;for(let n=0;n<t.length;n++){const l=t[n].UUID,c=t[n].locked,m=document.createElement("summary");m.className="segmentSummary";const p=document.createElement("span");p.id="sponsorTimesCategoryColorCircle"+l,p.style.backgroundColor=null===(s=i.default.config.barTypes[t[n].category])||void 0===s?void 0:s.color,p.classList.add("dot"),p.classList.add("sponsorTimesCategoryColorCircle");let g="";t[n].hidden===a.SponsorHideType.Downvoted?g=" ("+chrome.i18n.getMessage("hiddenDueToDownvote")+")":t[n].hidden===a.SponsorHideType.MinimumDuration?g=" ("+chrome.i18n.getMessage("hiddenDueToDuration")+")":t[n].hidden===a.SponsorHideType.Hidden&&(g=" ("+chrome.i18n.getMessage("manuallyHidden")+")");const h=document.createTextNode(u.shortCategoryName(t[n].category)+g),f=document.createElement("div");t[n].actionType===a.ActionType.Full?f.innerText=chrome.i18n.getMessage("full"):f.innerText=u.getFormattedTime(t[n].segment[0],!0)+(t[n].actionType!==a.ActionType.Poi?" "+chrome.i18n.getMessage("to")+" "+u.getFormattedTime(t[n].segment[1],!0):""),f.style.margin="5px";const y=document.createElement("div");y.appendChild(p);const v=document.createElement("span");v.className="summaryLabel",v.appendChild(h),y.appendChild(v),m.appendChild(y),m.appendChild(f);const T=document.createElement("details");T.classList.add("votingButtons");const C=document.createElement("div");C.id="sponsorTimesVoteButtonsContainer"+l,C.classList.add("sbVoteButtonsContainer");const S=document.createElement("img");S.id="sponsorTimesUpvoteButtonsContainer"+l,S.className="voteButton",S.title=chrome.i18n.getMessage("upvote"),S.src=chrome.runtime.getURL("icons/thumbs_up.svg"),S.addEventListener("click",(()=>L(1,l)));const w=document.createElement("img");w.id="sponsorTimesDownvoteButtonsContainer"+l,w.className="voteButton",w.title=chrome.i18n.getMessage("downvote"),w.src=c&&r?chrome.runtime.getURL("icons/thumbs_down_locked.svg"):chrome.runtime.getURL("icons/thumbs_down.svg"),w.addEventListener("click",(()=>L(0,l)));const b=document.createElement("img");b.id="sponsorTimesCopyUUIDButtonContainer"+l,b.className="voteButton",b.src=chrome.runtime.getURL("icons/clipboard.svg"),b.title=chrome.i18n.getMessage("copySegmentID"),b.addEventListener("click",(()=>{D(l),d.AnimationUtils.applyLoadingAnimation(b,.3)()}));const k=document.createElement("img");k.id="sponsorTimesCopyUUIDButtonContainer"+l,k.className="voteButton",k.title=chrome.i18n.getMessage("hideSegment"),t[n].hidden===a.SponsorHideType.Hidden?k.src=chrome.runtime.getURL("icons/not_visible.svg"):k.src=chrome.runtime.getURL("icons/visible.svg"),k.addEventListener("click",(()=>{d.AnimationUtils.applyLoadingAnimation(k,.4)(),t[n].hidden===a.SponsorHideType.Hidden?(k.src=chrome.runtime.getURL("icons/visible.svg"),t[n].hidden=a.SponsorHideType.Visible):(k.src=chrome.runtime.getURL("icons/not_visible.svg"),t[n].hidden=a.SponsorHideType.Hidden),e.query({active:!0,currentWindow:!0},(s=>{e.sendMessage(s[0].id,{message:"hideSegment",type:t[n].hidden,UUID:l})}))})),C.appendChild(S),C.appendChild(w),C.appendChild(b),t[n].actionType===a.ActionType.Skip&&[a.SponsorHideType.Visible,a.SponsorHideType.Hidden].includes(t[n].hidden)&&C.appendChild(k);const E=document.createElement("div");E.id="sponsorTimesVoteStatusContainer"+l,E.classList.add("sponsorTimesVoteStatusContainer"),E.style.display="none";const M=document.createElement("div");M.id="sponsorTimesThanksForVotingText"+l,M.classList.add("sponsorTimesThanksForVotingText"),E.appendChild(M),T.append(m),T.append(C),T.append(E),o.appendChild(T)}}}(n)):g.videoFound.innerHTML=chrome.i18n.getMessage("sponsor404")),e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"isChannelWhitelisted"},(function(e){e.value&&(g.whitelistChannel.style.display="none",g.unwhitelistChannel.style.display="unset",g.whitelistToggle.checked=!0,document.querySelectorAll(".SBWhitelistIcon")[0].classList.add("rotated"))}))})))}function v(e){n=e.creatingSegment,n||(s=i.default.config.unsubmittedSegments[o]||[]),T()}function T(){g.sponsorStart.innerText=chrome.i18n.getMessage(n?"sponsorEnd":"sponsorStart"),g.submitTimes.style.display=s&&s.length>0?"unset":"none",g.submissionHint.style.display=s&&s.length>0?"unset":"none"}function C(e){chrome.runtime.sendMessage({message:"openConfig",hash:e})}function S(n){return new Promise((s=>{e.query({active:!0,currentWindow:!0},(t=>{e.sendMessage(t[0].id,n,(e=>s(e)))}))}))}function w(){g.usernameInput.value=g.usernameValue.innerText,g.submitUsername.style.display="unset",g.usernameInput.style.display="unset",g.setUsernameContainer.style.display="none",g.setUsername.style.display="flex",g.setUsername.classList.add("SBExpanded"),g.setUsernameStatus.style.display="none",g.sponsorTimesContributionsContainer.classList.add("hidden")}function b(){document.getElementById("loadingIndicator").innerText=chrome.i18n.getMessage("noVideoID")}function k(e,n){document.getElementById("sponsorTimesVoteButtonsContainer"+n).style.display="none",document.getElementById("sponsorTimesVoteStatusContainer"+n).style.removeProperty("display"),document.getElementById("sponsorTimesThanksForVotingText"+n).innerText=e}function L(n,s){k(chrome.i18n.getMessage("Loading"),s),e.query({active:!0,currentWindow:!0},(t=>{e.sendMessage(t[0].id,{message:"submitVote",type:n,UUID:s},(function(e){null!=e&&(1==e.successType||-1==e.successType&&429==e.statusCode?k(chrome.i18n.getMessage("voted"),s):-1==e.successType&&k(l.GenericUtils.getErrorMessage(e.statusCode,e.responseText),s))}))}))}function D(e){window===window.top?window.navigator.clipboard.writeText(e):S({message:"copyToClipboard",text:e})}function E(e){e=Math.round(10*e)/10;const n=Math.floor(e/1440),s=Math.floor(e/60)%24;return(n>0?n+chrome.i18n.getMessage("dayAbbreviation")+" ":"")+(s>0?s+chrome.i18n.getMessage("hourAbbreviation")+" ":"")+(e%60).toFixed(1)}null!=f&&f&&(g.showNoticeAgain.style.display="unset"),u.sendRequestToServer("GET","/api/userInfo?value=userName&value=viewCount&value=minutesSaved&value=vip&userID="+i.default.config.userID,(e=>{if(200===e.status){const n=JSON.parse(e.responseText);g.usernameValue.innerText=n.userName;const s=n.viewCount;0!=s&&(g.sponsorTimesViewsDisplayEndWord.innerText=s>1?chrome.i18n.getMessage("Segments"):chrome.i18n.getMessage("Segment"),g.sponsorTimesViewsDisplay.innerText=s.toLocaleString(),g.sponsorTimesViewsContainer.style.display="block"),function(e){i.default.config.showDonationLink&&i.default.config.donateClicked<=0&&i.default.config.showPopupDonationCount<5&&e<5e4&&!i.default.config.isVip&&i.default.config.skipCount>10&&(g.sponsorTimesDonateContainer.style.display="flex",g.sbConsiderDonateLink.addEventListener("click",(()=>{i.default.config.donateClicked=i.default.config.donateClicked+1})),g.sbCloseDonate.addEventListener("click",(()=>{g.sponsorTimesDonateContainer.style.display="none",i.default.config.showPopupDonationCount=100})),i.default.config.showPopupDonationCount=i.default.config.showPopupDonationCount+1)}(s);const t=n.minutesSaved;0!=t&&(g.sponsorTimesOthersTimeSavedEndWord.innerText=1!=t?chrome.i18n.getMessage("minsLower"):chrome.i18n.getMessage("minLower"),g.sponsorTimesOthersTimeSavedDisplay.innerText=E(t)),i.default.config.isVip=n.vip}})),null!=i.default.config.sponsorTimesContributed&&(g.sponsorTimesContributionsDisplay.innerText=i.default.config.sponsorTimesContributed.toLocaleString(),g.sponsorTimesContributionsContainer.classList.remove("hidden")),null!=i.default.config.skipCount&&(1!=i.default.config.skipCount?g.sponsorTimesSkipsDoneEndWord.innerText=chrome.i18n.getMessage("Segments"):g.sponsorTimesSkipsDoneEndWord.innerText=chrome.i18n.getMessage("Segment"),g.sponsorTimesSkipsDoneDisplay.innerText=i.default.config.skipCount.toLocaleString(),g.sponsorTimesSkipsDoneContainer.style.display="block"),null!=i.default.config.minutesSaved&&(1!=i.default.config.minutesSaved?g.sponsorTimeSavedEndWord.innerText=chrome.i18n.getMessage("minsLower"):g.sponsorTimeSavedEndWord.innerText=chrome.i18n.getMessage("minLower"),g.sponsorTimeSavedDisplay.innerText=E(i.default.config.minutesSaved)),setTimeout((()=>g.sponsorblockPopup.classList.remove("preload")),250)}))}()}},s={};function t(e){var i=s[e];if(void 0!==i)return i.exports;var o=s[e]={exports:{}};return n[e].call(o.exports,o,o.exports,t),o.exports}t.m=n,e=[],t.O=(n,s,i,o)=>{if(!s){var a=1/0;for(c=0;c<e.length;c++){for(var[s,i,o]=e[c],r=!0,d=0;d<s.length;d++)(!1&o||a>=o)&&Object.keys(t.O).every((e=>t.O[e](s[d])))?s.splice(d--,1):(r=!1,o<a&&(a=o));if(r){e.splice(c--,1);var l=i();void 0!==l&&(n=l)}}return n}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,i,o]},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={42:0};t.O.j=n=>0===e[n];var n=(n,s)=>{var i,o,[a,r,d]=s,l=0;if(a.some((n=>0!==e[n]))){for(i in r)t.o(r,i)&&(t.m[i]=r[i]);if(d)var c=d(t)}for(n&&n(s);l<a.length;l++)o=a[l],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(c)},s=self.webpackChunksponsorblock=self.webpackChunksponsorblock||[];s.forEach(n.bind(null,0)),s.push=n.bind(null,s.push.bind(s))})();var i=t.O(void 0,[736],(()=>t(170)));i=t.O(i)})();